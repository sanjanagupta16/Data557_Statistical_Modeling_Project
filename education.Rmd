---
title: "education"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
df = read.csv("cleaned_df.csv")
df$relationship_val <- as.numeric(substr(df$RELATIONSHIP_QUALITY, 2, 2))
df = df[c('relationship_val', 'diff_in_education', 'RESPONDENT_YRSED', 'PARTNER_YRSED')]
df = na.omit(df) 
library(gplots)
library(ggplot2)
```

```{r}
hist(df$relationship_val)
summary(df$relationship_val)
```

## Difference in Education 

```{r}
hist(df$diff_in_education)
summary(df$diff_in_education)
```






## T-test

```{r}
length(df$relationship_val[df$diff_in_education != 0])
length(df$relationship_val[df$diff_in_education == 0])

mean(df$relationship_val[df$diff_in_education != 0])
mean(df$relationship_val[df$diff_in_education == 0])


var(df$relationship_val[df$diff_in_education != 0])
var(df$relationship_val[df$diff_in_education == 0])


ed_difference <- df$relationship_val[df$diff_in_education != 0]
no_ed_difference <- df$relationship_val[df$diff_in_education == 0]

model1 <- t.test(ed_difference, no_ed_difference, var.equal = FALSE)
model1
```


```{r}

df$same_diff_ed[df$diff_in_education != 0] = 'Different Education'
df$same_diff_ed[df$diff_in_education == 0] = 'Same Education'

plotmeans(relationship_val ~ same_diff_ed, 
          data = df, 
          xlab = "Education Categories", 
          ylab = "Relationship Quality",
          barcol = "lightgray",
          mean.labels = FALSE,
          connect = FALSE,
          n.label = FALSE,
          main="Mean Relationship Quality vs. Education Categories") 
```




## Difference in Education - Linear Regression


```{r}
fit = lm(relationship_val ~ diff_in_education, data=df)
summary(fit)
```

```{r}
plot(fit)
```

## Absolute Value of Difference in Education


```{r}
df$abs_diff_in_education = abs(df$diff_in_education)
hist(df$abs_diff_in_education)
summary(df$abs_diff_in_education)
```


## Absolute Value of Difference in Education - Linear Regression


```{r}
df$abs_diff_in_education = abs(df$diff_in_education)
fit = lm(relationship_val ~ abs_diff_in_education, data=df)
summary(fit)
```



```{r}
plot(fit)
```


## ANOVA on created categorical field


```{r}



df$diff_in_education = df$RESPONDENT_YRSED - df$PARTNER_YRSED
df$respondent_vs_partner = ''

df$respondent_vs_partner[df$diff_in_education < 0] = 'partner' 
df$respondent_vs_partner[df$diff_in_education > 0] = 'respondent'
df$respondent_vs_partner[df$diff_in_education == 0] = 'same_ed'







barplot(prop.table(table(df$respondent_vs_partner)))
```

```{r}
plotmeans(relationship_val ~ respondent_vs_partner, 
          data = df, 
          xlab = "Education Categories", 
          ylab = "Relationship Quality",
          barcol = "lightgray",
          mean.labels = FALSE,
          connect = FALSE,
          n.label = FALSE,
          main="Mean Relationship Quality vs. Education Categories") 
```


```{r}
fit = aov(relationship_val ~ factor(respondent_vs_partner), data=df)
summary(fit)
```

```{r}
partner <- df$relationship_val[df$respondent_vs_partner == 'partner']
respondent <- df$relationship_val[df$respondent_vs_partner == 'respondent']
same_ed <- df$relationship_val[df$respondent_vs_partner == 'same_ed']

p_samp <- sample(partner, 900, replace = FALSE, prob = NULL)
r_samp <- sample(respondent, 900, replace = FALSE, prob = NULL)
s_samp <- sample(same_ed, 900, replace = FALSE, prob = NULL)

t.test(p_samp,r_samp,paired=T)
t.test(p_samp,s_samp,paired=T)
t.test(r_samp,s_samp,paired=T)
```






```{r}
m=tapply(df$relationship_val,df$respondent_vs_partner,mean)[tapply(df$relationship_val,df$respondent_vs_partner)]
#summary(fit$residuals)
df$Residual = df$relationship_val - m
boxplot(Residual ~ respondent_vs_partner, data=df)
```



```{r}


plot(fit)

```


```{r}
length(df[df$respondent_vs_partner == 'same_ed',]$relationship_val)
length(df[df$respondent_vs_partner == 'partner',]$relationship_val)
length(df[df$respondent_vs_partner == 'respondent',]$relationship_val)
```


```{r}
var(df[df$respondent_vs_partner == 'same_ed',]$relationship_val)
var(df[df$respondent_vs_partner == 'partner',]$relationship_val)
var(df[df$respondent_vs_partner == 'respondent',]$relationship_val)
```


```{r}
mean(df$relationship_val[df$respondent_vs_partner == 'same_ed'])
mean(df$relationship_val[df$respondent_vs_partner == 'partner'])
mean(df$relationship_val[df$respondent_vs_partner == 'respondent'])
```










## Old - Ignore Below



## Anova Model on categorical Respondent Years of Education and categorical Partner Years of Education

```{r}
summary(aov(relationship_val ~ factor(RESPONDENT_YRSED) + factor(PARTNER_YRSED), data=df))
summary(aov(relationship_val ~ factor(RESPONDENT_YRSED)*factor(PARTNER_YRSED), data=df))
```

## Anova Model on "Large" Differences in Education vs "Non Large" Differences in Education

```{r}
df$large_diff_in_education <- ifelse(df$abs_diff_in_education >= 4.0, "large", "not large")

summary(aov(relationship_val ~ factor(large_diff_in_education), data=df))
```

```{r}
plot(df$abs_diff_in_education, df$relationship_val)
```


```{r}

fit = lm(relationship_val ~ abs_diff_in_education, data=df)
qqnorm(fit$residuals)
qqline(fit$residuals)

```
```{r}

par(mfrow=c(2,2),mar=c(5,4,2,1))
plot(fit)

```

## Closer Looker at Couples who have different education levels

```{r}
df_different_education <- df[df$abs_diff_in_education!=0.0,]
hist(df_different_education$abs_diff_in_education)
summary(df_different_education$abs_diff_in_education)
```

```{r}
summary(lm(relationship_val ~ abs_diff_in_education, data=df_different_education))
```




```{r}
summary(glm(relationship_val ~ factor(respondent_vs_partner), data = df, family=poisson))$coef
```







